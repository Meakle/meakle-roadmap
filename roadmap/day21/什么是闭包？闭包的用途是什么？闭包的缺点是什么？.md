# 什么是闭包？闭包的用途是什么？闭包的缺点是什么？

## 什么是闭包

> 一个函数和对其周围状态（**lexical environment，词法环境**）的引用捆绑在一起（或者说函数被引用包围），这样的组合就是**闭包**（**closure**）。
>
> ——[MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures)



闭包是一种语法现象，由一个函数，以及创建函数的词法环境组成。



JS中典型的闭包比如有：

函数里面套个函数，通过内部的函数（closure）来访问外部函数（init）中的局部变量。

```JavaScript
function init(){

    let a = 1;

    function closure() {
        console.log(a);
    }
    
    return closure;
}

let closure = init();
closure();
```

## 闭包的用途

1. 能够读取函数内部的变量，隐藏内部变量，避免污染全局变量，实现模块。

```js
let person = - function Person(name, age) {

    let getName = function() {
        console.log(name);
    }

    let getAge = function() {
        console.log(age);
    }

    return {
        getName: getName(),
        getAge: getAge(),
    }

}('meakle', 12);

person.getName;
person.getAge;
```

2. 能使函数内部的变量一直存在于内存中。

```js
for (var i = 1; i < 10; i++) {
    // 创建一个立即执行函数, 每一次的for循环都会调用这个函数
    // 而这个函数的参数会记住当前循环中i的值
    // 并且这个值由于内部的箭头函数引用了这个值, 因此这个值会一直存在内存中, 不会被回收
    (function (i) {

        setTimeout(() => {
            console.log(i);
        }, 1000 * i)

    })(i);
}
```

## 闭包的缺点

1. 占用内存

   因为内部的函数会引用其词法环境中的变量。所有被在闭包中的变量将一直存在于内存当中。

2. 在IE中可能会导致内存溢出